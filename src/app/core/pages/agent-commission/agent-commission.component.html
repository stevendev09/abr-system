<div class="container mt-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12 text-center">
            <h1 class="text-primary">
                <i class="bi bi-file-earmark-excel"></i> Lector de Archivos Excel
            </h1>
            <p class="text-muted">Sube un archivo Excel para visualizar su contenido</p>
        </div>
    </div>

    <!-- Upload Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-upload"></i> Subir Archivo
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <input type="file" class="form-control" (change)="onFileSelected($event)"
                                accept=".xlsx, .xls" #fileInput id="excelFile">
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex gap-2">
                                <button class="btn btn-success" (click)="readExcel()" [disabled]="!selectedFile">
                                    <i class="bi bi-eye"></i> Ver Contenido
                                </button>
                                <button class="btn btn-outline-secondary" (click)="clearData()"
                                    [disabled]="!excelData.length">
                                    <i class="bi bi-trash"></i> Limpiar
                                </button>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="selectedFile" class="mt-3">
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle"></i>
                            <strong>Archivo seleccionado:</strong> {{ selectedFile.name }}
                            <br>
                            <strong>Tama√±o:</strong> {{ (selectedFile.size / 1024).toFixed(2) }} KB
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics -->
    <!-- Statistics -->
    <div *ngIf="excelData.length > 0" class="row mb-3">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-md-2">
                            <div class="stat-item">
                                <h4 class="text-primary">{{ excelData.length }}</h4>
                                <small class="text-muted">Registros</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="stat-item">
                                <h4 class="text-success">{{ displayedHeaders.length }}</h4>
                                <small class="text-muted">Columnas</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="stat-item">
                                <h4 class="text-warning">{{ getTotalMontoGanadoSum() | currency }}</h4>
                                <small class="text-muted">Total Monto</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="stat-item">
                                <h4 class="text-info">{{ getTotalColumnaTresSum() | currency }}</h4>
                                <small class="text-muted">Total Col3</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="stat-item">
                                <h4 class="text-info">{{ getSheetName() }}</h4>
                                <small class="text-muted">Hoja</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="stat-item">
                                <button class="btn btn-outline-primary btn-sm" (click)="downloadJSON()">
                                    <i class="bi bi-download"></i> Exportar
                                </button>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="stat-item">
                                <button class="btn btn-outline-primary btn-sm" (click)="exportToExcel()">
                                    <i class="bi bi-download"></i> Exportar excel
                                </button>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="stat-item">
                                <button class="btn btn-outline-primary btn-sm" (click)="exportToExcelWithFormatting()">
                                    <i class="bi bi-download"></i> Exportar excel 2
                                </button>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="stat-item">
                                <button class="btn btn-outline-primary btn-sm" (click)="exportToExcelWithAdvancedFormatting()">
                                    <i class="bi bi-download"></i> Exportar excel 2
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Table -->
    <!-- Data Table -->
    <div *ngIf="excelData.length > 0" class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-table"></i> Datos del Excel ({{ excelData.length }} registros)
                    </h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>#</th>
                                    <th *ngFor="let header of displayedHeaders">{{ header }}</th>
                                    <!-- <th>Acciones</th> -->
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let row of excelData; let i = index">
                                    <td class="text-center">{{ row.rowNumber }}</td>
                                    <td *ngFor="let header of displayedHeaders"
                                        [class.number-cell]="isNumber(row[header])"
                                        [class.text-end]="isNumber(row[header])">
                                        {{ formatCellValue(row[header]) }}
                                    </td>
                                    <!-- <td class="text-center">
                                        <button class="btn btn-danger btn-sm" (click)="deleteRow(i)" title="Eliminar">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </td> -->
                                </tr>
                                <!-- Fila de totales -->
                                <tr class="table-info fw-bold">
                                    <td class="text-center">TOTAL</td>
                                    <td *ngFor="let header of displayedHeaders"
                                        [class.text-end]="header === 'MONTO GANADO' || header === 'COLUMNA 3'">
                                        <ng-container *ngIf="header === 'MONTO GANADO'">
                                            {{ getTotalMontoGanadoSum() | currency }}
                                        </ng-container>
                                        <ng-container *ngIf="header === 'COLUMNA 3'">
                                            {{ getTotalColumnaTresSum() | currency }}
                                        </ng-container>
                                        <ng-container *ngIf="header !== 'MONTO GANADO' && header !== 'COLUMNA 3'">
                                            -
                                        </ng-container>
                                    </td>
                                    <td class="text-center">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!excelData.length" class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body text-center py-5">
                    <i class="bi bi-file-earmark-excel text-muted" style="font-size: 3rem;"></i>
                    <h4 class="text-muted mt-3">No hay datos para mostrar</h4>
                    <p class="text-muted">Sube un archivo Excel para comenzar</p>
                </div>
            </div>
        </div>
    </div>
</div>